import{r as h,b,u as j,a as v,j as e,H as N,q as y,g as m}from"./index-Bbliq6wx.js";import{C as i,a as d,B as l}from"./BookingCard-CQSKUtjr.js";const u="https://bookit-backend-d4l7.onrender.com",f=()=>y({queryKey:["bookings"],queryFn:async()=>{const t=m(),a=await fetch(`${u}/api/v1/bookings/mybook`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:t}});if(!a.ok){const o=await a.json();throw new Error(o.message)}return a.json()}});function B(){const[t,a]=h.useState("upcoming"),{data:o}=b(f()),g=j(),p=v({mutationFn:async s=>{const c=await(await fetch(`${u}/api/v1/bookings/${s}/cancel`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:m()}})).text();try{return JSON.parse(c)}catch{throw new Error(`Invalid JSON response: ${c}`)}},onSuccess:()=>{alert("cancel successful!"),g({to:"/my-bookings"})},onError:s=>{console.error("Booking failed:",s),alert("cancel failed: "+s.message)}}),n=o.data.filter(s=>new Date(s.booking_slot.end_time)>new Date&&s.status!="cancelled"),r=o.data.filter(s=>new Date(s.booking_slot.end_time)<new Date||s.status=="cancelled"),x=s=>{p.mutate(s),alert(`Cancelling booking ${s}`)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(N,{isAdmin:!1}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"mb-2",children:"My Bookings"}),e.jsx("p",{className:"text-muted-foreground",children:"View and manage your venue reservations"})]}),e.jsx("div",{className:"mb-6 border-b border-border",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>a("upcoming"),className:`pb-3 px-1 border-b-2 transition-colors flex items-center gap-2 ${t==="upcoming"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[e.jsx(i,{className:"h-4 w-4"}),"Upcoming"]}),e.jsxs("button",{onClick:()=>a("past"),className:`pb-3 px-1 border-b-2 transition-colors flex items-center gap-2 ${t==="past"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[e.jsx(d,{className:"h-4 w-4"}),"Past"]})]})}),t==="upcoming"&&e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsxs("div",{className:"text-center py-12 bg-muted/30 rounded-lg",children:[e.jsx(i,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"mb-2",children:"No Upcoming Bookings"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have any upcoming venue reservations"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(s=>e.jsx(l,{...s,showActions:!0,status:s.status,onCancel:x},s.id))})}),t==="past"&&e.jsx("div",{className:"space-y-4",children:r.length===0?e.jsxs("div",{className:"text-center py-12 bg-muted/30 rounded-lg",children:[e.jsx(d,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"mb-2",children:"No Past Bookings"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have any past venue reservations"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(s=>e.jsx(l,{...s,booking_slot:s.booking_slot},s.id))})})]})]})}export{B as component};
